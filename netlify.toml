[build]
  command   = "npm --workspace clawpoly-web run build"
  publish   = "web/dist"
  functions = "web/netlify/functions"

[functions]
  node_bundler = "esbuild"

# Explicit API â†’ Netlify function mapping (flat function names)
[[redirects]]
  from   = "/api/health"
  to     = "/.netlify/functions/health"
  status = 200

[[redirects]]
  from   = "/api/search/tx"
  to     = "/.netlify/functions/search-tx"
  status = 200

[[redirects]]
  from   = "/api/search/address"
  to     = "/.netlify/functions/search-address"
  status = 200

[[redirects]]
  from   = "/api/search/contract"
  to     = "/.netlify/functions/search-contract"
  status = 200

[[redirects]]
  from   = "/api/search/logs"
  to     = "/.netlify/functions/search-logs"
  status = 200

[[redirects]]
  from   = "/api/search/docs"
  to     = "/.netlify/functions/search-docs"
  status = 200

[[redirects]]
  from   = "/api/x402/endpoints"
  to     = "/.netlify/functions/x402-endpoints"
  status = 200

# SPA fallback
[[redirects]]
  from   = "/*"
  to     = "/index.html"
  status = 200
